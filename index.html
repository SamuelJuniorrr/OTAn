<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Torneio de Alian칞as</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #111;
      color: white;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
    }
    .ranking-inputs, .duelos, .ranking, .simulacao, .historico {
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background: #1a1a1a;
      border-radius: 12px;
    }
    .ranking-inputs input {
      width: 100%;
      padding: 10px;
      margin: 5px 0;
      background: #222;
      color: white;
      border: 1px solid #444;
      border-radius: 8px;
    }
    button {
      padding: 10px 20px;
      margin: 10px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .btn-green { background-color: #28a745; color: white; }
    .btn-blue { background-color: #007bff; color: white; }
    .btn-yellow { background-color: #ffc107; color: black; }
    .btn-red { background-color: #dc3545; color: white; }
    .duelo-card {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      margin: 10px 0;
      background: #2b2b2b;
      border-radius: 10px;
    }
    .duelo-card span {
      flex: 1;
      padding: 10px;
      margin: 0 5px;
      text-align: center;
      border-radius: 6px;
      cursor: pointer;
      background: #333;
    }
    .vencedor {
      background-color: #00b300 !important;
      font-weight: bold;
    }
    .otan {
      color: gold;
      background: #333322;
      font-weight: bold;
    }
    .seta-up { color: limegreen; }
    .seta-down { color: red; }
    @media (max-width: 600px) {
      .duelo-card {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <h1>Torneio de Alian칞as</h1>
  <div class="ranking-inputs" id="input-section">
    <h2>游릴 Entrada do Ranking Inicial</h2>
    <div id="inputs"></div>
    <button class="btn-green" onclick="iniciarTorneio()">Iniciar Torneio</button>
  </div>

  <div class="ranking" id="ranking-section" style="display:none">
    <h2>Ranking Atual</h2>
    <ol id="ranking-list"></ol>
  </div>

  <div class="duelos" id="duelos-section" style="display:none">
    <h2>游릱 Confrontos Semanais</h2>
    <div id="duelos"></div>
    <button class="btn-yellow" id="btn-simular" style="display:none" onclick="simularSemana()">Simular Pr칩xima Semana</button>
  </div>

  <div class="simulacao" id="simulacao-section" style="display:none">
    <h2>游릳 Simula칞칚o da Pr칩xima Semana</h2>
    <ol id="simulacao-list"></ol>
    <button class="btn-blue" onclick="confirmarSemana()">Confirmar Semana</button>
  </div>

  <div class="historico" id="historico-section" style="display:none">
    <h2>游린 Hist칩rico de Resultados</h2>
    <div id="historico"></div>
  </div>

  <div style="text-align:center; margin-top: 30px">
    <button class="btn-red" onclick="reiniciarTemporada()">Reiniciar Temporada</button>
    <button class="btn-blue" onclick="exportarResultado()">Exportar Resultado</button>
  </div>

  <script>
    let ranking = [];
    let semana = 1;
    let historico = [];
    let vencedores = [];

    const inputsDiv = document.getElementById('inputs');
    for (let i = 1; i <= 16; i++) {
      const input = document.createElement('input');
      input.placeholder = `Alian칞a ${i}`;
      inputsDiv.appendChild(input);
    }

    function iniciarTorneio() {
      const inputs = document.querySelectorAll('#inputs input');
      ranking = Array.from(inputs).map(i => i.value.trim());
      if (ranking.includes("")) {
        alert("Preencha todos os campos antes de iniciar.");
        return;
      }
      atualizarRanking();
      gerarConfrontos();
      document.getElementById('input-section').style.display = 'none';
      document.getElementById('ranking-section').style.display = 'block';
      document.getElementById('duelos-section').style.display = 'block';
    }

    function atualizarRanking(preview = false) {
      const lista = preview ? document.getElementById('simulacao-list') : document.getElementById('ranking-list');
      lista.innerHTML = "";
      ranking.forEach((nome, i) => {
        const li = document.createElement('li');
        li.innerHTML = `<span class="${nome.toUpperCase() === 'OTAN' ? 'otan' : ''}">${nome}</span>`;
        if (preview) {
          const oldIndex = rankingAtual.findIndex(n => n === nome);
          const diff = oldIndex - i;
          if (diff > 0) li.innerHTML += ` <span class='seta-up'>&uarr;</span>`;
          else if (diff < 0) li.innerHTML += ` <span class='seta-down'>&darr;</span>`;
        }
        lista.appendChild(li);
      });
    }

    function gerarConfrontos() {
      vencedores = [];
      document.getElementById('btn-simular').style.display = 'none';
      document.getElementById('simulacao-section').style.display = 'none';
      const duelosDiv = document.getElementById('duelos');
      duelosDiv.innerHTML = "";
      for (let i = 0; i < 16; i += 2) {
        const duelo = document.createElement('div');
        duelo.className = 'duelo-card';
        duelo.innerHTML = `
          <span onclick="selecionarVencedor(${i}, '${ranking[i]}', this)">${ranking[i]}</span>
          <span onclick="selecionarVencedor(${i}, '${ranking[i+1]}', this)">${ranking[i+1]}</span>`;
        duelosDiv.appendChild(duelo);
      }
    }

    function selecionarVencedor(index, nome, elemento) {
      const duelo = elemento.parentNode;
      duelo.querySelectorAll('span').forEach(s => s.classList.remove('vencedor'));
      elemento.classList.add('vencedor');
      vencedores[index] = nome;
      if (vencedores.filter(Boolean).length === 8) {
        document.getElementById('btn-simular').style.display = 'inline-block';
      }
    }

    let rankingAtual = [];
    function simularSemana() {
      rankingAtual = [...ranking];
      const perdedores = [];
      for (let i = 0; i < 16; i += 2) {
        const v = vencedores[i];
        const p = ranking[i] === v ? ranking[i+1] : ranking[i];
        perdedores.push(p);
      }
      ranking = ranking.filter(n => !vencedores.includes(n) && !perdedores.includes(n));
      ranking = [
        ...vencedores.sort((a, b) => rankingAtual.indexOf(a) - rankingAtual.indexOf(b)),
        ...perdedores.sort((a, b) => rankingAtual.indexOf(a) - rankingAtual.indexOf(b)),
        ...ranking
      ];
      document.getElementById('simulacao-section').style.display = 'block';
      atualizarRanking(true);
    }

    function confirmarSemana() {
      historico.push({ semana, duelos: vencedores });
      semana++;
      atualizarRanking();
      gerarConfrontos();
      exibirHistorico();
      document.getElementById('simulacao-section').style.display = 'none';
    }

    function exibirHistorico() {
      const div = document.getElementById('historico');
      div.innerHTML = "";
      historico.forEach((semanaData, i) => {
        const bloco = document.createElement('div');
        bloco.innerHTML = `<h3>Semana ${i + 1}</h3><ul>` + semanaData.duelos.map(d => `<li>${d}</li>`).join('') + '</ul>';
        div.appendChild(bloco);
      });
      document.getElementById('historico-section').style.display = 'block';
    }

    function reiniciarTemporada() {
      if (!confirm("Deseja reiniciar o torneio?")) return;
      window.location.reload();
    }

    function exportarResultado() {
      let conteudo = `Ranking Final:\n` + ranking.map((r, i) => `${i + 1}. ${r}`).join('\n') + '\n\nHist칩rico:\n';
      historico.forEach((semanaData, i) => {
        conteudo += `Semana ${i + 1}:\n` + semanaData.duelos.join(', ') + '\n';
      });
      const blob = new Blob([conteudo], { type: 'text/plain' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'resultado_torneio.txt';
      a.click();
    }
  </script>
</body>
</html>
